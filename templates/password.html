<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Checker | Swiss Security Knife</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <nav>
        <div class="nav-container">
            <button class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-left">
                <span class="logo">
                    <span>üîê</span>
                    <span>Swiss Security Knife</span>
                </span>
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode">
                    <span id="themeIcon">üåô</span>
                </button>
            </div>
            <ul class="nav-links" id="navLinks">
                <li><a href="/" class="active">Password Checker</a></li>
                <li><a href="/hash-identifier">Hash Identifier</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="card">
            <div class="card-header">
                <h1>üîí Password Security Checker</h1>
                <p>Test your password against security best practices</p>
            </div>
            <div class="card-body">
                <form method="POST" action="/">
                    <div class="form-group">
                        <label for="password">Enter Password:</label>
                        <input
                            type="password"
                            id="password"
                            name="password"
                            placeholder="Enter your password"
                            value="{{.Password}}"
                            required
                            autocomplete="off"
                        >
                    </div>
                    <div class="button-group">
                        <button type="submit" class="btn-primary">Check Password</button>
                        <button type="button" class="btn-secondary" onclick="togglePassword()">
                            <span id="toggleText">Show Password</span>
                        </button>
                    </div>
                </form>

                {{if .Result}}
                <div class="strength-display">
                    <div class="strength-badge strength-{{.Result.Strength}}">
                        {{.Result.Strength}}
                    </div>
                    <div class="score-display">
                        <strong>Score: {{.Result.Score}}/8</strong> requirements met
                    </div>
                </div>

                <div>
                    <h2 style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">Security Requirements</h2>
                    <ul class="requirements-list">
                        <li class="{{if .Result.Results.Length}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Length}}‚úì{{else}}‚úó{{end}}</span>
                            <span>At least 12 characters long</span>
                        </li>
                        <li class="{{if .Result.Results.Uppercase}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Uppercase}}‚úì{{else}}‚úó{{end}}</span>
                            <span>Contains uppercase letter (A-Z)</span>
                        </li>
                        <li class="{{if .Result.Results.Lowercase}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Lowercase}}‚úì{{else}}‚úó{{end}}</span>
                            <span>Contains lowercase letter (a-z)</span>
                        </li>
                        <li class="{{if .Result.Results.Number}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Number}}‚úì{{else}}‚úó{{end}}</span>
                            <span>Contains number (0-9)</span>
                        </li>
                        <li class="{{if .Result.Results.Special}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Special}}‚úì{{else}}‚úó{{end}}</span>
                            <span>Contains special character (!@#$%^&*)</span>
                        </li>
                        <li class="{{if .Result.Results.Common}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Common}}‚úì{{else}}‚úó{{end}}</span>
                            <span>Not a common password</span>
                        </li>
                        <li class="{{if .Result.Results.Repeated}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Repeated}}‚úì{{else}}‚úó{{end}}</span>
                            <span>No repeated characters (3+ times)</span>
                        </li>
                        <li class="{{if .Result.Results.Sequential}}met{{else}}failed{{end}}">
                            <span class="icon">{{if .Result.Results.Sequential}}‚úì{{else}}‚úó{{end}}</span>
                            <span>No sequential characters (abc, 123)</span>
                        </li>
                    </ul>
                </div>

                <div class="alert {{if .Result.Valid}}alert-success{{else}}alert-warning{{end}}">
                    {{.Result.Message}}
                </div>
                {{end}}
            </div>
        </div>

        <div class="info-box">
            <h2>üí° Password Best Practices</h2>
            <ul class="info-list">
                <li>Use a unique password for each account</li>
                <li>Consider using a passphrase (e.g., "Coffee-Morning-Sunrise-42!")</li>
                <li>Enable two-factor authentication when available</li>
                <li>Use a password manager to store passwords securely</li>
                <li>Change passwords if you suspect a breach</li>
            </ul>
        </div>
    </main>

    <footer>
        <p><strong>Swiss Security Knife</strong> - Collection of common security tools</p>
        <p>Built with Go | Open Source</p>
    </footer>

    <script src="/static/theme.js"></script>
    <script>
        function togglePassword() {
            const field = document.getElementById('password');
            const text = document.getElementById('toggleText');
            if (field.type === 'password') {
                field.type = 'text';
                text.textContent = 'Hide Password';
            } else {
                field.type = 'password';
                text.textContent = 'Show Password';
            }
        }

        function toggleMenu() {
            document.querySelector('.hamburger').classList.toggle('active');
            document.getElementById('navLinks').classList.toggle('active');
            document.body.classList.toggle('menu-open');
        }

        document.addEventListener('click', function(e) {
            const nav = document.querySelector('nav');
            const links = document.getElementById('navLinks');
            const hamburger = document.querySelector('.hamburger');

            if (!nav.contains(e.target) && links.classList.contains('active')) {
                hamburger.classList.remove('active');
                links.classList.remove('active');
                document.body.classList.remove('menu-open');
            }
        });
    </script>
</body>
</html>
